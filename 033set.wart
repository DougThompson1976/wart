(mac wart-set places
  `(do ,@(map0 (fn(x) `(= ,x t))
               places)))
(defover set wart-set)

(mac wipe places
  `(do ,@(map0 (fn(x) `(= ,x nil))
               places)))

(macro-alias rotate rotatef)

(mac swap(place1 place2)
  `(rotate ,place1 ,place2))

(mac zap(f place . args)
  `(= ,place (,f ,place ,@args)))

(mac accum(accfn . body)
  `(let ,$acc nil
     (labels ((,accfn(_) (push _ ,$acc)))
       ,@body)
     (rev ,$acc)))
