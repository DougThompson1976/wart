//// numbers

:(before "End Globals")
unordered_map<long, cell*> Int_literals;
:(before "End Test Teardown")
  Int_literals.clear();

:(code)
cell* new_num(long x) {
  if (Int_literals[x])
    return Int_literals[x];
  Int_literals[x] = new_cell();
  Int_literals[x]->left = (cell*)x;
  Int_literals[x]->type = INTEGER;
  return Int_literals[x];
}

cell* new_num(int x) {   // just for integer literals
  return new_num((long)x);
}

bool is_num(cell* x) {
  return x->type == INTEGER;
}

long to_int(cell* x) {
  // ignore endianness; cells are never persisted
  if (x->type == INTEGER)
    return (long)x->left;
  RAISE << "not a number: " << x << '\n';
  return 0;
}
