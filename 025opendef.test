(wt-eval '(def foo(a b) :case (oddp a) b))
(test "guarded def clauses using :case"
  :valueof (list (foo 33 2) (foo 4 2))
  :should be (list 2 4))

(wt-eval '(mac foomac2(x) :case (floatp x)
            `(+ 3.0 ,x)))
(test "mac :case works"
  :valueof (foomac2 3.67)
  :should be 6.67)

(test "mac :case doesn't override"
  :valueof (foomac2 3)
  :should be 4)
