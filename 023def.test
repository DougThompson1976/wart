(defun foo() 34)
(test "simple defun works as before"
  :valueof (foo)
  :should be 34)

(progn
  (defun foo0() 3)
  (defun foo1() (+ 1 (foo0))))
(test "nested defuns work as before"
  :valueof (foo1)
  :should be 4)

(progn
  (defmacro foo2(n) `(+ 1 ,n))
  (defmacro foo3(n) `(+ 1 (foo2 ,n))))
(test "nested macros work as before"
  :valueof (foo3 2)
  :should be 4)

(wt-eval '(def foo(a) 34))
(test "def sets wart-signatures*"
  :valueof (gethash 'foo wart-signatures*)
  :should match '((_ _)))

(wt-eval '(def foo(a b) a))
(test "subsequent defs overload"
  :valueof (len (gethash 'foo wart-signatures*))
  :should be 2)

(test "both versions of def coexist"
  :valueof (list (foo 2) (foo 3 2))
  :should be (list 34 3))

(test "final version always works"
  :valueof (foo)
  :should be 34)
