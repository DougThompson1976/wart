(test-wart "pairp works"
  :valueof (pairp '(1 2))
  :should satisfy true_value)

(test-wart "call works on simple functions"
  :valueof (call #'car '(1))
  :should be 1)

(test-wart "call works on simple functions"
  :valueof (call #'car '(1))
  :should be 1)

(test-wart "call coerces to function when necessary"
  :valueof (call 'car '(1))
  :should be 1)

(test-wart "call works on lambdas"
  :valueof (call [+ _ 1] 3)
  :should be 4)

(test "match"
  :valueof (match 3 3)
  :should be t)

(test "match"
  :valueof (match 3 4)
  :should be nil)

(test "match"
  :valueof (match '(1 (2 3)) '(1 (2 3)))
  :should be t)

(test "match"
  :valueof (match '(2 (2 3)) '(1 (2 3)))
  :should be nil)

(test "match"
  :valueof (match 3 '_)
  :should be t)

(test "match"
  :valueof (match '(1 (2 3)) '(1 (_ 3)))
  :should be t)

(test "match"
  :valueof (match '(2 (2 3)) '(1 (_ 3)))
  :should be nil)
