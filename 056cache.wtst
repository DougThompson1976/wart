(wt-eval '(do
            (= counter 0)
            (defcache foocache 1 ++.counter)))
(test-wart "defcache is like def the first call"
  :valueof (do (foocache) counter)
  :should be 1)

(test-wart "defcache saves results within timeout"
  :valueof (do (foocache) counter)
  :should be 1)

(test-wart "defcache recomputes after timeout"
  :valueof (do (sleep 1) (foocache) counter)
  :should be 2)
