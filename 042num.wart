(defcoerce integer string
  'write-to-string)
(defcoerce string integer
  'read-from-string)

(defgeneric wart-> args
  (apply '> args))
(defover > wart->)
(defgeneric wart-< args
  (apply '< args))
(defover < wart-<)

(def wart-int(x ? base 10)
  (if (isa x 'string)
    (parse-integer x :radix base)
    (as integer x)))
(defover int wart-int)

(def mapn(f a b)
  (call rev^accumulate :over a :taking f :next '1+ :unless [> _ b]))
