(defcoerce integer string
  'write-to-string)
(defcoerce string integer
  'read-from-string)

(def wart-int(x ? base 10)
  (if (isa x 'string)
    (parse-integer x :radix base)
    (as integer x)))
(defover int wart-int)

(def mapn(f a b)
  (call rev^accumulate :over a :taking f :next '1+ :unless [> _ b]))
