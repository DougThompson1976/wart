(def treewise(f base tree)
  (if (atom tree)
    (call base tree)
    (call f (treewise f base car.tree)
            (treewise f base cdr.tree))))

(def tree-subst(old new tree)
  (if (iso tree old)
       new
      (atom tree)
       tree
      (cons (tree-subst old new car.tree)
            (tree-subst old new cdr.tree))))

(def ontree(f tree)
  (call f tree)
  (unless atom.tree
    (ontree f car.tree)
    (ontree f cdr.tree)))
